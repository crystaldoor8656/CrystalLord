# 产品需求文档 (PRD)
# 《地球新主》(CrystalLord)

**版本**: 1.0
**最后更新**: 2026-01-12
**产品类型**: LBS生存类游戏
**目标平台**: iOS (App Store)

---

## 1. 产品概述

### 1.1 产品定位
《地球新主》是一款基于真实地理位置的生存开拓类手机游戏，采用"希望朋克"视觉风格，融合GPS圈地、POI探索、资源管理、建造系统和社交互动等核心玩法。

### 1.2 世界观背景
- **2048年**: "终末战争"爆发，全球文明在72小时内崩塌，99%人口消失
- **2051年**: 幸存者从废墟中走出，《新开拓者协议》颁布
- **核心法则**: "凡以双足丈量之无主土地，皆为开拓者所有"
- **视觉风格**: "希望朋克" - 废土之上的新生，绝望中的希望

### 1.3 核心玩法循环
```
登录注册 → 圈地占领 → 探索搜刮 → 获得资源
    ↑                              ↓
    │         ┌──────────────────────────────┐
    │         │  资源用途：                    │
    │         │  • 建造建筑（消耗资源）         │
    │         │  • 交易换物（流通资源）         │
    │         │  • 生存消耗（食物/水）          │
    │         └──────────────────────────────┘
    │                              ↓
    └──────── 通讯社交 ← 成就排行 ← 发展壮大
```

### 1.4 产品目标
- 创造一款独特的LBS + 生存游戏体验
- 利用AI辅助开发实现快速迭代
- 验证"Walk to Earn"商业模式
- 支持全球化运营（多语言、Apple生态）

---

## 2. 目标用户

### 2.1 核心用户画像
- **年龄**: 18-35岁
- **特征**: 喜欢户外活动、探索新地点、收集养成类游戏
- **参考游戏**: 《宝可梦GO》《Ingress》《僵尸快跑》
- **使用场景**: 日常通勤、周末外出、运动健身

### 2.2 用户需求
- **娱乐需求**: 有趣的户外游戏体验
- **社交需求**: 与附近玩家互动交流
- **成就需求**: 收集、排行榜、徽章系统
- **健康需求**: 激励多走路、多运动

---

## 3. 核心功能模块

### 3.1 功能架构

#### 第一部分：登录与圈地系统
- **登录注册系统** (第一阶段)
- **GPS圈地系统** (第二阶段)
- **领地管理** (第三阶段)

#### 第二部分：探索与资源获取
- **POI发现与搜刮** (第四阶段)
- **背包系统** (第五阶段)

#### 第三部分：建造与交易系统
- **建造系统** (第六阶段)
- **建筑状态管理** (第七阶段)
- **交易系统** (第八阶段)

#### 第四部分：通讯系统
- **消息中心** (第九阶段)
- **公共频道聊天** (第十阶段)
- **频道管理** (第十一阶段)
- **PTT呼叫** (第十二阶段)
- **设备等级** (第十三阶段)

#### 第五部分：个人中心与商业化
- **个人主页** (第十四阶段)
- **多语言设置** (第十六阶段)
- **付费订阅系统** (第十七阶段)
- **排行榜** (第十九阶段)
- **成就系统** (第二十阶段)
- **生存体征** (第二十一阶段)

---

## 4. 详细功能需求

### 4.1 第一阶段：登录注册系统

**优先级**: P0 (核心功能)

#### 功能描述
用户身份认证系统，支持多种登录方式。

#### 功能需求
1. **邮箱注册**
   - 用户名 + 密码方式
   - 邮箱验证功能
   - 密码重置功能

2. **Apple登录**
   - Sign in with Apple集成
   - 一键快速登录
   - 隐私保护邮箱

3. **Google登录**
   - Google OAuth集成
   - 适配海外用户

#### 技术实现
- 使用 Supabase Auth
- 支持会话管理
- 多设备登录支持

#### 验收标准
- [ ] 三种登录方式均可正常使用
- [ ] 登录状态持久化
- [ ] 密码重置邮件正常发送
- [ ] 首次登录自动创建用户档案

---

### 4.2 第二阶段：GPS圈地系统

**优先级**: P0 (核心功能)

#### 功能描述
用户通过实际行走在地图上绘制轨迹，形成闭合多边形后即可占领该区域作为领地。

#### 功能需求
1. **开始圈地**
   - 点击"开始开拓"按钮
   - 实时记录GPS轨迹
   - 轨迹以蓝色线条显示在地图上

2. **轨迹绘制**
   - 最小间隔5米记录一个点
   - 实时在地图上渲染轨迹
   - 自动检测轨迹闭合（起点和终点距离<50米）

3. **闭合验证**
   - 检测多边形是否有效（无自交）
   - 检测是否与其他玩家领地重叠
   - 检测面积是否在合法范围内（100m² - 1000000m²）
   - 检测是否存在作弊行为（速度过快）

4. **领地创建**
   - 验证通过后，创建领地记录
   - 自动命名或用户自定义命名
   - 记录面积、边界坐标、创建时间

#### 技术实现
- 使用 Apple MapKit
- CoreLocation 获取GPS数据
- PostGIS 存储地理空间数据
- 多边形算法检测自交和重叠

#### 数据结构
```swift
struct Territory {
    id: UUID
    name: String
    owner_id: UUID
    area: Double // 平方米
    boundary: Polygon // GeoJSON格式
    created_at: Date
    allow_trading: Bool
}
```

#### 验收标准
- [ ] GPS轨迹实时显示准确
- [ ] 闭合检测灵敏度<50米
- [ ] 重叠检测100%准确
- [ ] 作弊检测：速度>20km/h拒绝
- [ ] 领地数据成功存储到云端

---

### 4.3 第三阶段：领地管理

**优先级**: P0 (核心功能)

#### 功能描述
用户查看和管理自己拥有的领地，包括命名、查看详情、设置交易权限等。

#### 功能需求
1. **领地列表**
   - 显示用户所有领地
   - 每个领地显示：名称、面积、建筑数量、创建时间

2. **领地详情**
   - 在地图上显示领地边界
   - 显示领地内的建筑物位置
   - 显示领地统计数据

3. **领地设置**
   - 修改领地名称
   - 允许/禁止交易开关
   - 删除领地（仅限空领地）

4. **活跃度机制**
   - 30天内必须开始建设
   - 90天内必须保持活跃
   - 不活跃领地将被回收

#### 验收标准
- [ ] 领地列表加载速度<1秒
- [ ] 领地边界在地图上正确显示
- [ ] 交易权限设置即时生效
- [ ] 活跃度倒计时准确

---

### 4.4 第四阶段：POI发现与搜刮

**优先级**: P0 (核心功能)

#### 功能描述
用户行走时自动发现附近的兴趣点（POI），可以对其进行"搜刮"获取对应类型的资源。

#### 功能需求
1. **POI自动发现**
   - 检测玩家位置与POI距离
   - 距离<50米时触发发现
   - 弹出提示："发现兴趣点"

2. **POI类型与资源映射**
   - **医院/药店** → 药品（急救包、抗生素）
   - **超市/餐厅** → 食物（罐头、饮用水）
   - **工厂/工地** → 金属材料
   - **公园/林地** → 木材
   - **银行/珠宝店** → 稀有材料

3. **搜刮机制**
   - 点击"搜刮"按钮
   - 显示探索成就页面：距离、时长、获得物品
   - 物品自动添加到背包
   - 同一POI冷却时间：24小时

4. **探索统计**
   - 记录探索距离
   - 记录探索时长
   - 记录搜刮次数

#### 技术实现
- 使用 Apple MapKit POI数据
- 地理围栏技术（Geofencing）
- 资源掉落算法（基于POI类型和稀有度）

#### 数据结构
```swift
struct POI {
    id: UUID
    name: String
    category: String
    location: Coordinate
    last_looted: Date?
}

struct ExplorationRecord {
    id: UUID
    user_id: UUID
    poi_id: UUID
    distance: Double
    duration: TimeInterval
    items_obtained: [Item]
    timestamp: Date
}
```

#### 验收标准
- [ ] POI发现距离准确（50米）
- [ ] 资源类型与POI匹配100%
- [ ] 冷却时间准确（24小时）
- [ ] 探索数据正确记录

---

### 4.5 第五阶段：背包系统

**优先级**: P0 (核心功能)

#### 功能描述
用户管理收集到的所有物品，包括查看、使用、丢弃等操作。

#### 功能需求
1. **背包界面**
   - 显示容量：已用/总容量
   - 物品列表：图标、名称、数量
   - 物品分类：全部、食物、材料、工具、特殊

2. **物品操作**
   - 查看物品详情
   - 使用物品（消耗品）
   - 丢弃物品

3. **容量管理**
   - 初始容量：100格
   - 扩容方式：建造仓库
   - 满容量时无法继续搜刮

4. **本地优先架构**
   - 数据先存本地
   - 异步同步到云端
   - 离线也能查看和使用

#### 技术实现
- SwiftData 本地存储
- Supabase 云端同步
- 后台同步队列

#### 数据结构
```swift
struct Inventory {
    user_id: UUID
    capacity: Int
    items: [InventoryItem]
}

struct InventoryItem {
    item_id: UUID
    quantity: Int
    acquired_at: Date
}

struct Item {
    id: UUID
    name: String
    description: String
    category: String
    rarity: String
    icon: String
}
```

#### 验收标准
- [ ] 背包容量计算准确
- [ ] 物品数量实时更新
- [ ] 使用物品即时生效
- [ ] 离线模式正常工作
- [ ] 网络恢复后自动同步

---

### 4.6 第六阶段：建造系统

**优先级**: P1 (重要功能)

#### 功能描述
用户在自己的领地内使用资源建造各种建筑物。

#### 功能需求
1. **建筑模板**
   - 15种建筑类型
   - 分为4大类：生存、储存、生产、能源
   - 3个等级：Tier 1、Tier 2、Tier 3

2. **建造流程**
   - 选择建筑类型
   - 检查资源是否足够
   - 在领地内选择位置
   - 消耗资源，创建建筑

3. **建筑分类**
   - **生存类**: 篝火（取暖）、庇护所（休息）
   - **储存类**: 小仓库、中仓库、大仓库
   - **生产类**: 农田、工作台、炼金台
   - **能源类**: 太阳能板、风力发电机

4. **建造限制**
   - 必须在自己的领地内
   - 每个领地建筑数量上限：20个
   - 建筑之间最小距离：10米

#### 技术实现
- 建筑模板配置表
- 资源扣除事务处理
- 位置碰撞检测

#### 数据结构
```swift
struct Building {
    id: UUID
    template_id: String
    territory_id: UUID
    owner_id: UUID
    location: Coordinate
    status: BuildingStatus // 建造中、待激活、运行中、损坏
    level: Int
    created_at: Date
}

struct BuildingTemplate {
    id: String
    name: String
    category: String
    tier: Int
    required_resources: [String: Int]
    build_time: TimeInterval
    effects: [String: Any]
}
```

#### 验收标准
- [ ] 资源检查准确
- [ ] 建筑位置限制生效
- [ ] 建造后资源正确扣除
- [ ] 建筑在地图上正确显示

---

### 4.7 第七阶段：建筑状态管理

**优先级**: P1 (重要功能)

#### 功能描述
建筑拥有不同状态，支持激活、升级、维修等操作。

#### 功能需求
1. **建筑状态**
   - **建造中**: 施工阶段，倒计时
   - **待激活**: 建造完成，需要手动激活
   - **运行中**: 正常工作，产生效果
   - **损坏**: 需要维修才能继续使用

2. **状态操作**
   - 激活：消耗少量资源
   - 升级：消耗资源，提升等级
   - 维修：恢复损坏状态
   - 拆除：回收部分资源

3. **状态机规则**
   - 建造中 → 待激活（时间到达）
   - 待激活 → 运行中（手动激活）
   - 运行中 → 损坏（随机事件）
   - 损坏 → 运行中（维修）
   - 任何状态 → 删除（拆除）

#### 验收标准
- [ ] 状态流转逻辑正确
- [ ] 只能在合法状态下执行操作
- [ ] 状态变更即时同步

---

### 4.8 第八阶段：交易系统

**优先级**: P1 (重要功能)

#### 功能描述
玩家之间基于位置的物物交换系统。

#### 功能需求
1. **发布挂单**
   - 选择"我提供"的物品和数量
   - 选择"我需要"的物品和数量
   - 发布后挂单对外可见

2. **发现挂单**
   - 进入其他玩家领地100米范围内
   - 该玩家开启了"允许交易"
   - 显示该玩家的挂单列表

3. **交易流程**
   - 查看挂单详情
   - 确认接受交易
   - 检查双方资源是否足够
   - 执行物品交换
   - 记录交易历史

4. **交易限制**
   - 必须在100米范围内
   - 双方资源必须充足
   - 不支持金币交易（纯物物交换）

#### 技术实现
- 基于位置的查询
- 原子事务保证交易安全
- 实时推送交易通知

#### 数据结构
```swift
struct TradeOffer {
    id: UUID
    owner_id: UUID
    territory_id: UUID
    offering_items: [String: Int]
    requesting_items: [String: Int]
    status: String // active, completed, cancelled
    created_at: Date
}

struct TradeTransaction {
    id: UUID
    offer_id: UUID
    buyer_id: UUID
    seller_id: UUID
    timestamp: Date
}
```

#### 验收标准
- [ ] 100米距离检测准确
- [ ] 交易原子性保证（全部成功或全部失败）
- [ ] 交易历史正确记录
- [ ] 双方都收到通知

---

### 4.9 第九阶段：消息中心

**优先级**: P2 (一般功能)

#### 功能描述
系统消息推送中心，包括官方公告、任务通知等。

#### 功能需求
1. **消息类型**
   - 官方消息：公告、更新、活动
   - 生存指南：新手教程
   - 每日任务：任务列表

2. **消息展示**
   - 消息列表
   - 未读标识
   - 消息详情

3. **推送通知**
   - 本地通知
   - 远程推送（APNs）

#### 验收标准
- [ ] 消息正常接收
- [ ] 未读状态准确
- [ ] 推送通知及时送达

---

### 4.10 第十阶段：公共频道聊天

**优先级**: P1 (重要功能)

#### 功能描述
基于位置的公共聊天室，3km范围内玩家可见。

#### 功能需求
1. **聊天功能**
   - 发送文本消息
   - 实时消息推送
   - 显示发送者昵称和时间

2. **范围限制**
   - 覆盖范围：3km
   - 只有3km内玩家能看到消息
   - 移出范围后自动退出

3. **消息管理**
   - 消息历史记录
   - 自动清理7天前消息

#### 技术实现
- Supabase Realtime
- 基于位置的消息过滤
- WebSocket长连接

#### 数据结构
```swift
struct Message {
    id: UUID
    sender_id: UUID
    channel_id: String
    content: String
    location: Coordinate
    timestamp: Date
}
```

#### 验收标准
- [ ] 消息秒级送达
- [ ] 3km范围判断准确
- [ ] 消息顺序正确
- [ ] 历史消息正常加载

---

### 4.11 第十一阶段：频道管理

**优先级**: P2 (一般功能)

#### 功能描述
用户创建和加入特定主题的聊天频道。

#### 功能需求
1. **创建频道**
   - 输入频道名称和描述
   - 设置频道类型（公开/私密）
   - 设置成员上限

2. **频道列表**
   - 显示附近的频道
   - 显示距离和在线人数
   - 支持搜索和筛选

3. **加入/退出**
   - 加入公开频道
   - 申请加入私密频道
   - 随时退出频道

#### 验收标准
- [ ] 频道创建成功
- [ ] 频道列表正确显示
- [ ] 加入退出正常工作

---

### 4.12 第十二阶段：PTT呼叫

**优先级**: P2 (一般功能)

#### 功能描述
模拟真实对讲机的Push-to-Talk功能。

#### 功能需求
1. **PTT操作**
   - 长按麦克风按钮录音
   - 松开按钮发送
   - 显示正在通话状态

2. **音频处理**
   - 录制音频
   - 压缩音频（减少带宽）
   - 播放音频

3. **频道选择**
   - 在当前频道发送
   - 显示当前频率

#### 技术实现
- AVFoundation 音频录制
- 音频压缩（AAC格式）
- Supabase Storage 存储音频

#### 验收标准
- [ ] 录音功能正常
- [ ] 音频质量清晰
- [ ] 播放流畅无卡顿

---

### 4.13 第十三阶段：设备等级

**优先级**: P2 (一般功能)

#### 功能描述
通讯设备分级，限制通讯能力。

#### 功能需求
1. **设备类型**
   - **收音机**: 只能接收，不能发送，免费
   - **对讲机**: 可收发，3km范围，需购买或升级
   - **营地电台**: 10km范围，需建造
   - **卫星通讯**: 全球范围，最高级

2. **设备升级**
   - 使用资源或付费升级
   - 解锁更高级功能

#### 验收标准
- [ ] 设备权限限制生效
- [ ] 升级流程顺畅
- [ ] 范围限制准确

---

### 4.14 第十四阶段：个人主页

**优先级**: P1 (重要功能)

#### 功能描述
展示玩家的游戏数据和成就。

#### 功能需求
1. **基础信息**
   - 昵称、头像
   - 开拓天数
   - 幸存者等级

2. **数据统计**
   - 领地数量和总面积
   - 建筑数量
   - 探索距离
   - 搜刮次数

3. **个人设置**
   - 修改昵称
   - 更换头像
   - 隐私设置

#### 验收标准
- [ ] 数据统计准确
- [ ] 信息修改即时生效
- [ ] 头像上传正常

---

### 4.15 第十六阶段：多语言设置

**优先级**: P2 (一般功能)

#### 功能描述
支持多种语言，适配全球市场。

#### 功能需求
1. **支持语言**
   - 简体中文
   - 繁体中文
   - English

2. **语言切换**
   - 设置界面选择语言
   - 重启应用生效
   - 所有文本自动翻译

#### 技术实现
- NSLocalizedString
- .strings 文件管理
- AI辅助翻译

#### 验收标准
- [ ] 语言切换成功
- [ ] 所有文本正确翻译
- [ ] 无遗漏和错误

---

### 4.16 第十七阶段：付费订阅系统

**优先级**: P0 (核心功能，商业化)

#### 功能描述
内购系统，包括订阅和一次性购买。

#### 功能需求
1. **订阅选项**
   - **开拓者月卡** $9.99/月
     - 无限探索
     - 范围扩大2倍
     - 每日资源包
   - **领主通行证** $19.99/月
     - 包含月卡所有特权
     - 专属建筑
     - VIP标识

2. **资源包**
   - 初级物资包 $0.99
   - 中级物资包 $2.99
   - 高级物资包 $4.99
   - 稀有资源包 $9.99

3. **购买流程**
   - 展示商品列表
   - 点击购买
   - Apple支付
   - 发放奖励

#### 技术实现
- StoreKit 2
- 订阅自动续费
- 收据验证
- 恢复购买

#### 验收标准
- [ ] 商品正确显示
- [ ] 购买流程顺畅
- [ ] 订阅自动续费
- [ ] 奖励正确发放
- [ ] 支持恢复购买

---

### 4.17 第十九阶段：排行榜

**优先级**: P2 (一般功能)

#### 功能描述
玩家排名系统，激励竞争。

#### 功能需求
1. **榜单类型**
   - 领地面积榜
   - 探索废墟榜
   - 建筑数量榜

2. **排行榜展示**
   - 前100名玩家
   - 显示排名、昵称、数值
   - 自己的排名高亮

3. **更新机制**
   - 每5分钟更新一次
   - 缓存减少数据库压力

#### 技术实现
- 数据库窗口函数（RANK()）
- Redis缓存（可选）
- 分页加载

#### 验收标准
- [ ] 排名计算准确
- [ ] 自己排名正确显示
- [ ] 加载速度<2秒

---

### 4.18 第二十阶段：成就系统

**优先级**: P2 (一般功能)

#### 功能描述
游戏成就和徽章系统，引导玩家体验游戏。

#### 功能需求
1. **成就分类**
   - 新手成就（引导功能）
   - 进阶成就（挑战目标）
   - 稀有成就（限定条件）

2. **成就奖励**
   - 金币奖励
   - 特殊称号
   - 徽章收藏

3. **成就检测**
   - 自动检测达成条件
   - 弹窗提示
   - 记录完成时间

#### 技术实现
- EventBus 发布订阅模式
- 成就配置表
- 自动触发检测

#### 数据结构
```swift
struct Achievement {
    id: String
    name: String
    description: String
    rarity: String
    reward_coins: Int
    condition: String
}

struct UserAchievement {
    user_id: UUID
    achievement_id: String
    completed_at: Date
}
```

#### 验收标准
- [ ] 成就自动检测准确
- [ ] 奖励正确发放
- [ ] 完成进度显示正确

---

### 4.19 第二十一阶段：生存体征

**优先级**: P1 (重要功能)

#### 功能描述
模拟真实生存状态，资源需要持续消耗。

#### 功能需求
1. **体征数值**
   - **核心生命**: 0-100，降到0死亡
   - **饱食度**: 0-100%，低于20开始掉血
   - **水分**: 0-100%，低于20开始掉血

2. **衰减机制**
   - 饱食度：每小时 -5%
   - 水分：每小时 -10%
   - 核心生命：体征过低时 -1/小时

3. **恢复方式**
   - 使用食物恢复饱食度
   - 使用饮用水恢复水分
   - 使用医疗包恢复生命

4. **增益效果**
   - 饱食度和水分 >80%时
   - 探索范围+20%
   - 资源掉落+10%

#### 技术实现
- 定时器检测（10分钟）
- 计算上次检查到现在的衰减量
- 后台模式计算

#### 验收标准
- [ ] 衰减速率准确
- [ ] 使用物品正确恢复
- [ ] 增益效果生效
- [ ] 死亡惩罚正确执行

---

## 5. 技术架构

### 5.1 技术栈
- **前端**: Swift + SwiftUI
- **地图**: Apple MapKit
- **定位**: CoreLocation
- **后端**: Supabase
  - 认证: Supabase Auth
  - 数据库: PostgreSQL + PostGIS
  - 实时通讯: Supabase Realtime
  - 存储: Supabase Storage
- **支付**: StoreKit 2
- **本地存储**: SwiftData

### 5.2 架构模式
- MVVM (Model-View-ViewModel)
- 本地优先架构
- 事件驱动架构（EventBus）
- 状态机模式

### 5.3 性能要求
- 地图加载时间 <2秒
- GPS定位延迟 <3秒
- 消息送达延迟 <1秒
- 数据同步延迟 <5秒
- 支持10万+并发用户

---

## 6. 数据库设计

### 6.1 核心表结构

#### users（用户表）
```sql
CREATE TABLE users (
    id UUID PRIMARY KEY,
    email TEXT UNIQUE,
    nickname TEXT,
    avatar_url TEXT,
    created_at TIMESTAMP,
    last_active TIMESTAMP,
    survival_days INT DEFAULT 0,
    level INT DEFAULT 1
);
```

#### territories（领地表）
```sql
CREATE TABLE territories (
    id UUID PRIMARY KEY,
    name TEXT,
    owner_id UUID REFERENCES users(id),
    boundary GEOGRAPHY(POLYGON),
    area DOUBLE PRECISION,
    allow_trading BOOLEAN DEFAULT false,
    created_at TIMESTAMP,
    last_active TIMESTAMP
);
```

#### buildings（建筑表）
```sql
CREATE TABLE buildings (
    id UUID PRIMARY KEY,
    template_id TEXT,
    territory_id UUID REFERENCES territories(id),
    owner_id UUID REFERENCES users(id),
    location GEOGRAPHY(POINT),
    status TEXT,
    level INT DEFAULT 1,
    created_at TIMESTAMP
);
```

#### inventory（背包表）
```sql
CREATE TABLE inventory (
    user_id UUID REFERENCES users(id),
    item_id TEXT,
    quantity INT,
    acquired_at TIMESTAMP,
    PRIMARY KEY (user_id, item_id)
);
```

#### trade_offers（交易挂单表）
```sql
CREATE TABLE trade_offers (
    id UUID PRIMARY KEY,
    owner_id UUID REFERENCES users(id),
    territory_id UUID REFERENCES territories(id),
    offering_items JSONB,
    requesting_items JSONB,
    status TEXT,
    created_at TIMESTAMP
);
```

#### messages（消息表）
```sql
CREATE TABLE messages (
    id UUID PRIMARY KEY,
    sender_id UUID REFERENCES users(id),
    channel_id TEXT,
    content TEXT,
    location GEOGRAPHY(POINT),
    timestamp TIMESTAMP
);
```

---

## 7. 商业模式

### 7.1 收入来源
1. **订阅收入**（主要）
   - 开拓者月卡 $9.99/月
   - 领主通行证 $19.99/月
   - 预计转化率：5-8%

2. **内购道具**（次要）
   - 资源包 $0.99 - $9.99
   - 特殊建筑
   - 装饰物品

3. **广告收入**（可选）
   - 激励视频广告
   - 观看广告获得资源

### 7.2 成本结构
- Supabase服务费：免费版 → Pro $25/月
- Apple开发者账号：$99/年
- 服务器（如需要）：$50-200/月
- AI辅助开发成本：$20/月（Claude订阅）

### 7.3 盈利预测
假设：
- 月活用户：10,000人
- 付费转化率：5%
- ARPPU（付费用户平均收入）：$15/月

**月收入** = 10,000 × 5% × $15 = **$7,500/月**

---

## 8. 成功指标 (KPI)

### 8.1 用户增长指标
- **DAU** (日活跃用户)：目标 1,000+
- **MAU** (月活跃用户)：目标 10,000+
- **留存率**：
  - 次日留存：>40%
  - 7日留存：>20%
  - 30日留存：>10%

### 8.2 用户参与度指标
- **日均游戏时长**：>15分钟
- **日均圈地数**：>0.5次
- **日均探索POI数**：>2个
- **社交互动率**：>30%（发送过消息的用户比例）

### 8.3 商业化指标
- **付费转化率**：>5%
- **ARPU** (平均每用户收入)：>$0.75/月
- **ARPPU** (付费用户平均收入)：>$15/月
- **LTV** (用户生命周期价值)：>$50

### 8.4 技术指标
- **Crash率**：<1%
- **应用启动时间**：<3秒
- **GPS定位成功率**：>95%
- **消息送达率**：>99%

---

## 9. 上线计划

### 9.1 MVP版本 (v1.0)
**时间**: 第1-3周
**功能**:
- ✅ 登录注册
- ✅ GPS圈地
- ✅ 领地管理
- ✅ POI探索
- ✅ 背包系统
- ✅ 建造系统
- ✅ 交易系统

### 9.2 社交版本 (v1.1)
**时间**: 第4-5周
**功能**:
- ✅ 公共聊天
- ✅ 频道管理
- ✅ PTT呼叫

### 9.3 商业化版本 (v1.2)
**时间**: 第6周
**功能**:
- ✅ 付费订阅
- ✅ 内购道具
- ✅ 排行榜
- ✅ 成就系统

### 9.4 生存版本 (v1.3)
**时间**: 第7周
**功能**:
- ✅ 生存体征
- ✅ 资源消耗
- ✅ 生存挑战

---

## 10. 风险与挑战

### 10.1 技术风险
1. **GPS精度问题**
   - 风险：室内/隧道GPS信号弱
   - 应对：使用GPS + 基站 + WiFi融合定位

2. **电池消耗**
   - 风险：持续GPS耗电大
   - 应对：智能省电模式，静止时降低定位频率

3. **数据同步冲突**
   - 风险：多设备登录数据不一致
   - 应对：服务器时间戳+冲突解决策略

### 10.2 运营风险
1. **用户流失**
   - 风险：新手引导不足导致流失
   - 应对：成就系统引导 + 新手奖励

2. **作弊行为**
   - 风险：虚拟定位、加速器
   - 应对：速度检测 + 行为分析 + 封号机制

3. **内容不足**
   - 风险：后期玩法单一
   - 应对：定期更新活动 + PvP玩法 + 联盟系统

### 10.3 政策风险
1. **隐私政策**
   - 风险：位置数据隐私合规
   - 应对：严格遵守GDPR和App Store隐私要求

2. **地图数据**
   - 风险：某些国家地图服务受限
   - 应对：使用Apple MapKit（全球可用）

---

## 11. 后续迭代方向

### 11.1 v2.0 功能规划
- **联盟系统**: 多人协作开拓大型领地
- **PvP对抗**: 领地争夺战
- **宠物系统**: 收集和培养废土生物
- **剧情任务**: 探索世界观背景故事
- **AR模式**: AR扫描建筑，沉浸式体验

### 11.2 全球化
- 支持更多语言（日语、韩语、西班牙语等）
- 本地化运营（不同地区活动）
- 社区管理（Discord、Reddit）

### 11.3 技术升级
- SwiftUI 全面迁移
- visionOS 适配（支持Apple Vision Pro）
- 机器学习：智能推荐探索路线

---

## 12. 附录

### 12.1 参考竞品
- 《宝可梦GO》：LBS游戏标杆
- 《Ingress》：科幻风LBS游戏
- 《僵尸快跑》：运动+游戏结合
- 《地球末日》：生存建造游戏

### 12.2 开发资源
- 代码库：48,000行 Swift代码
- 开发工具：Xcode + Claude Code
- 后端服务：Supabase
- 设计工具：Figma

### 12.3 联系方式
- 产品负责人：[姓名]
- 技术负责人：[姓名]
- 项目周期：3周（已完成）
- 预算：¥1.5万

---

**文档结束**

*本文档由AI辅助生成，根据《地球新主》游戏功能讲解整理而成。*
